
# Conclusion

Our project was to determine if a bias could be observable and if some characteristics were significantly attributable to white and black races. 

To do so and after a comprehensive exploratory analysis on victims, police officers and arrestees, we created two models, a gaussian and a Poisson, to model the actual proportions of arrestees, and then a Random forest to classify them by their characteristics.

We used a biased sample and we knew that it is questionable to proceed with a non-representative sampling to draw conclusions needing careful handling. The 50-50 proportion of black and white among arrestees cannot represent the Chapel Hill’s population where black people are up to max. 12.5%.

We start easy with a simple gaussian model and refined it with a Poisson family, what better fits the data by reducing drast. Our linear models were somehow satisfying, mostly the Poisson one: coefficients were significant except the Arrestee race. This is an interesting insight: in fact, a model using a biased 50-50 sample making no difference between white and black people in its outcome precisely points out a problem.

Our regression tree is good at predicting black people (True Positive), a bit less in white arrestees (True Negative). In addition, it did errors of type I and II in non negligible proportion. (false black / white arrestee). We should have either weighting the outcomes to cope with this mix up, or randomly resample our dataset to obtain a representative subset and to train our classification model on it.

Our project gives some insights from the start on a potential racial bias: the dataset is itself not representative. We must as well remind that Chapel Hill is a State of South and might be impacted by its history, and using only one dataset does not allow us to draw universal conclusion, as we said in the introduction.

However, we dare say that a racial bias might be observable in the judicial system of Chapell Hill between 2015 and 2019, but must be further investigated to scope out the correlation between the police officers’ profiles and the arrestees typical profiles, and the characteristics imputable to the races among arrestees and police officers.

<!--chapter:end:Conclusion.Rmd-->


# Exploration analysis

In order to have a global overview about our table, we are going to have a zoom on each differents table.

## Police Employee Demographics

We start to analyse the dataset of the police officers. We would like to know the proportion of the ethnicities among police officers.We observe in the figure \@ref(fig:distribution-employee) that male gender and the white race are in majority. This distribution is captured in the current year of 2016.

```{r distribution-employee, fig.cap="Distribution of the employee", fig.align='center',warning=FALSE, message=FALSE, echo = FALSE}


Employee_demographics %>% 
  count(Gender,Race) %>%
  ggplot(aes(x=Race,y=n, fill= Race)) +
  geom_bar(stat = "identity") +
  facet_grid(~Gender)+
  theme(legend.position ="bottom") +
  theme(legend.key.size = unit(0.5, "cm"))  +
  labs(
    title = "Majority of male white employee",
    subtitle = "Current of the year 2016",
    x= "Race",
    y="Number of employee"
    ) 



```

Now our interest is to know which positions are the most occupied and by whom. 
Looking at the distribution of the job class in the figure \@ref(fig:distribution-employee), we note that almost all the police positions are attributed to white male people. It is an interesting point for a further analysis.

```{r distribution-job-employee, fig.cap="Distribution of the job", fig.align='center',warning=FALSE, message=FALSE, echo = FALSE}

Employee_demographics %>%
  group_by(`Job Class Description`) %>%
  count(`Job Class Description`, Gender, Race) %>% 
  arrange(desc(n)) %>%
  rename("Number of employee"=n)%>%
  head(7) %>%
  kable(
    caption= "Profession of the police officers by frequency", digits=2) %>%
  kable_styling(
    bootstrap_options = "striped"
    ) 


```


We found interesting to focus on the above job classes, which work in the field. We filtered thus Job Classes Despcription to obtain a subset including the post that figure in the table \@ref(fig:distribution-employee) as the more reccurent.

According to some studies run in the field, a chronic stress caused by police work is an explanation of the use of extralegal force [see @Griffin2003, pp.3--21]. In order to set this assumption, we run two investigations: Figure  \@ref(fig:distribution-serviceyear) depicts the modes of the service lengths among genders for the job cited right above. 

We observe that the service length is slightly longer for men than for women. The median ongoing career length for men is 15 years, whereas the women's is approximatively 6 years shorter (-40%). Even if newcomers lower the ongoing service length, such as the outlier in men's category, we observe that men are thus exposed on a longer period to a chronic stress, which is inherent to the job of police officer [More into details @Purba2019]

```{r distribution-serviceyear, fig.cap="Distribution of the police job", fig.align='center',warning=FALSE, message=FALSE, echo = FALSE}


Employee_demographics %>%
   filter( `Job Class Description` == c("POLICE OFFICER I","POLICE OFFICER II", "POLICE OFFICER III","POLICE OFFICER IV", "POLICE SERGEANT", "POLICE LIEUTENANT", "RESERVE POLICE OFFICER")) %>%
  group_by(Gender) %>%
  ggplot(aes(Gender,`Service Years`, color= Gender)) +
  geom_boxplot() +
  labs(
    title = "Women's service is shorter than the men: men's career are almost quite the double",
    subtitle = "Glimpse of the service length in the Chapel Hill Police District among gender",
    x = "Police officers' gender",
    y = "Service length",
    col = "Gender")


```


Considering now the gender among all categories of job classes, we observe that the police officers are mostly male teams, \@ref(fig:distribution-serviceyear). Out of the four grades, there are only 4 women. Women occupy mostly administrative jobs, not linked to the process nor decision making about arrestation. In this way, we can keep in mind that our analysis would focus mainly on male officers.


```{r distribution-serviceyear-employee, fig.cap="Distribution of the job by gender", fig.align='center',warning=FALSE, message=FALSE, echo = FALSE}
#Comupting the mean for the next plot
#Comupting the mean for the next plot
meanM<- Employee_demographics%>%
  group_by(Gender) %>%
  summarize(mean_service = mean(`Service Years`))

Employee_demographics %>%
  ggplot(aes(`Job Class Description`,`Service Years`)) + 
  geom_point(aes(color = Gender)) +
  geom_hline(yintercept = 14.24603, color = "darkblue") +
  geom_hline(yintercept = 12.02083, color = "pink") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, size =6)) +
   labs(
     title = "Female employees are more likely to be in administrative positions",
     subtitle = "The average service is slighty longer for men",
     y="Year of service"
     )

```

In order to contextualize this information, we had to know when those police officers started their career. We computed easily the age of enrollment for all positions (not only the job classes we filtered before), which is the result of their age minus their service length. The age at which the officers began their career is an important information, because young people are more mentally vulnerable than older ones [more details @Thomas2016). Starting one's career at a young age and being exposed to a chronic stress and traumatic events have more impact on the subject due to one's age. 

Among filtered job categories, the starting age is under 30 years old in average, as we observe in the \@ref(fig:distribution-serviceyear). All officers were thus early exposed to chronic stress, and more longer if they gained grades. The hierarchy cumulates more years of experience, what is intuitive because of the system of reward and the legitimization to obtain this position: the contrary would have been surprising.The hierarchy is not necessarily playing a direct role in the deicion making of arrestations. Yet, they give orders and guidelines to the police officers, installing a certain culture and mindset to the troops. 
Police officers' starting age takes part in the same interval than for their superior : between 25 and 30 years old. We have two police officers above this age, what could be explain by either a late career or a change in district. However, it seems that to reach the fourth level in police officer scale, the experience is a necessary element. Those policemens do not have less than 13 years old of experience, which is a large amount of time spent, by assumption, in streets and on missions.
Reserve police officers are experienced policemen kept as an option for mission.

For now, we have to ascertain if only those job classes follow the trend of young enrollment or if it is a general tendancy respected by all the human ressources of the CHPD.

```{r distribution-serviceyear-2, fig.cap="Distribution of the job by gender", fig.align='center',warning=FALSE, message=FALSE, echo = FALSE}


Employee_demographics %>%
  filter( `Job Class Description` == c("POLICE OFFICER I", "POLICE OFFICER II",  "POLICE OFFICER III","POLICE       OFFICER IV", "POLICE SERGEANT", "POLICE LIEUTENANT", "RESERVE POLICE OFFICER")) %>%
  mutate(AGEBEGINNING = Age - `Service Years`) %>%
  ggplot(aes( x = `Job Class Description`, y = AGEBEGINNING,color = `Job Class Description`))+
  geom_boxplot() +
  labs(
    title = "Beyond the early age of enrollment among classes, we note that Police officer's \ngrade is based on service length",
    subtitle = "Age of enrollment and service length per job class in CHPD",
    x = "Job Class",
    y = "Age of enrollment",
    caption = "data from Employee_demographics.csv")+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))


```


To match the previous information with race, we observe in this table \@ref(fig:distribution-serviceyear-race) that white employees are generally more experienced due to a longer career.

```{r distribution-serviceyear-race, fig.cap="Distribution of the job by race", fig.align='center',warning=FALSE, message=FALSE, echo = FALSE}


Employee_demographics %>%
  ggplot(aes(`Job Class Description`,`Service Years`)) + 
  geom_point(aes(color = Race)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, size =6)) +
   labs(
     title = "White race has generally a higher service year",
     y="Year of service"
     )
 
```

## Victims' socio-demographics 
Now, we are going to go through the victims data. We wanted to know the annual number of victims and their characteristics.  As a reminder, the data displayd observations from 2010 to 2019.
In Figure \@ref(fig:Victim-distribution), there is a clear distinction between black and white race: white victims outnumber easily black victims.The gender seems not to be significantly important since both graphs look like each other. 
We keep in mind that gender is not a help, but race plays a great role to profile the victim, among other variables.

```{r Victim-distribution, fig.cap="Distribution about the type of the victim", fig.align='center',warning=FALSE, message=FALSE, echo = FALSE}
Incident_reports= Incident_reports %>%
                  mutate(month=month(`Date of Occurrence`), year= year(`Date of Occurrence`))

Incident_reports %>%
  filter(year>=2010) %>%
  count(`Victim Race`, `Victim Gender` , year) %>%
  filter(`Victim Gender`!="NA") %>%
  ggplot(aes(x=year,y=n, fill= factor(`Victim Race`), col= `Victim Race`)) +
  geom_line() +
  facet_grid(~`Victim Gender`)+
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  theme(legend.position ="bottom") +
  theme(legend.key.size = unit(0.5, "cm"))  +
  labs(title = "White people are the major victim ",
       subtitle = "No significant differenent between the gender",
       x= "Year",
       y="Number of Victim") +
  scale_x_continuous( breaks = seq(2010,2019,by=1))
```



Now that we know the distribution of victims, it would be interesting to have a glimpse over the type of issue they suffered from. 
Therefore, the table \@ref(tab:Table-victim-crime) demonstrates the most frequent complaints involve theft. The third and fourth most frequent issues reported are "misc officier in" and "domestic distur".


```{r Table-victim-crime),warning=FALSE, message=FALSE, echo = FALSE}

Incident_reports %>%
  group_by(`Reported As`) %>%
  count(`Reported As`,`Victim Race`,`Victim Gender`) %>%
  arrange(desc(n)) %>%
  rename("Number of victim"=n) %>%
  na.omit() %>%
  head(10) %>%
   kable(
    caption= "Purpose of the crime", digits=2) %>%
  kable_styling(
    bootstrap_options = "striped"
    ) 


```




In the figure \@ref(fig:delay-occurence-report), we would like to know if there is a difference in process time for registering the complaint and the the arrestation process among race of victims. Even if there are some variations depending on the complexity of the case and the inherent time of investigation depending on the type of case, variation we cannot control, it would be interesting if there are anyway a global difference since our panel of 82'525 observations would somehow pool this variance.

Outliers are the typical cases showing this uncontrollable variation, we would neglect them and filter our dataset to observe only the delays inferior to 2000 days (more than 3 years). We observe that the time dedicated to investigation and arrestation for cases of white people is slightly higher than this time for black people. We would discard the assumption of a negligence in the treatment of cases related to black people.


```{r delay-occurence-report, fig.cap="Bloxplot about the delay between the occurence and the report", fig.align='center',warning=FALSE, message=FALSE, echo = FALSE}
Incident_reports%>%
  group_by(`Victim Race`)  %>%
  mutate(DELAYReported = `Date of Report`- `Date of Occurrence`, DELAYArrested = `Date Found`- `Date of Occurrence`) %>%
  filter( DELAYArrested < 20000 & DELAYArrested > 100) %>%
  ggplot( aes(x= `Victim Race`,y= DELAYArrested, color=`Victim Race`)) +
  geom_boxplot() +
  labs(
    title = "Higher delay between the occurence and the date of the report for the black race",
    subtitle = "More outliers for the white race",
    y="Delay between the occurence and the report" 
    )


```

## Arrestees' socio-demographics

In the data "Police arrested made", there are all the data of the criminals for their arrest from 2010 to 2019. The first thing we wished to observe is the number of arrests per month and per year (for a better visualization) classified by race of the person arrested.

In Figures \@ref(fig:Police-arrested-made-Black-White-month) and \@ref(fig:Police-arrested-made-Black-White-year), we observe that from 2015, the number of arrestations for black people increases.

The below figures show the number of arrestations by race and we note an equivalent proportion of black and white arestees. However, if we confront this information with the socio-demographic data of White Chapel in 2010, the black population represented only 9.9%. According to the data of [2020 World Population by Country(updated daily)](https://worldpopulationreview.com/) displaying the population of Chapel Hill and its population growth, the population growth between 2010 and 2018 was 6.24%, so let's assume that the population of black people increased by the same percentage, and the variation would be +/- 6.24% [0% or 12.48%] It would lead that in 2018, on year before our data, we should have 10.5% of black people in White Chapel Hill or a percentage included in [9.9% ; 11.17%]. Here, if we had to respect the proportion in the arrestee sample according to the white people number of arestees, it should be around 386 black aresteesin order to be representative of the whole population. The entered 3'651 black arrestees represent 945% of this extrapolation.

Since 2015, the trend is inverted and black arrestees sometimes outnumbers white people. Sometimes, the difference is shocking, for instance in March-April and July-August 2016 or June-July 2018. These differences are peaks that could be related to the meeting and strikes related to black shooting occuring in the year and to repeal  a law (HB2), as the articles enclosed in the appendix relate.[@Newobserver, title "Hundreds block downtown Chapel Hill to protest state’s HB2 law"]

We do neglect the possibility that mass movements could as well explain unusual peaks. However, as we mentioned earlier, the inverted trend is significantly verified in 2017, where white arrestees were a majority only during two first months. This fact could not be explained by mass movements.

```{r Police-arrested-made-Black-White-month, fig.cap="Evolution of the number of arrestation by month",fig.align='center', warning=FALSE, message=FALSE, echo = FALSE}

Police_arrest_made <-Police_arrest_made %>% 
 mutate(month=month(`Date of Arrest`),year=year(`Date of Arrest`))


Police_arrest_made %>% 
count(`Arrestee's Race`, month, year) %>%
ggplot(aes(x=month,y=n)) +
  geom_line(size=1, aes(color=`Arrestee's Race`)) +
  geom_point(aes(color=`Arrestee's Race`)) +
  facet_grid(~year) +
  stat_summary(fun.y = diff, geom = "bar") +
  theme(legend.position ="bottom")  +
  scale_x_continuous( breaks = c(1, 6, 12))+
  labs(
    title = "Monthly number of arrestations",
    x= "Month",
    y="Number of arrestations"
  )

```



```{r Police-arrested-made-Black-White-year, fig.cap="Evolution of the number of arrestation by year",fig.align='center', warning=FALSE, message=FALSE, echo = FALSE}
##Same plot as before, but only considering the year and not the month


Police_arrest_made %>%
count(`Arrestee's Race`, year,) %>%
ggplot(aes(x=year,y=n)) +
  geom_line(size=1, aes(color=`Arrestee's Race`)) +
  geom_point(aes(color=`Arrestee's Race`)) +
  stat_summary(fun.y = diff, geom = "bar") +
  theme(legend.position ="bottom")  +
   scale_x_continuous( breaks = seq(2010,2019,by=1))+
  labs(
    title = "Annual number of arrestations",
    x= "Year",
    y="Number of arrestation"
  )

 
```


After dividing the arrests by class, we wanted to know the gender of the arrestees and we observed, in the figure \@ref(fig:Arrestation-Male-Female-Black-White), that the number of men is in average 3 times the number of arrested women, both races combined. The male arrestees number remains above the 600 for white and for black (except in 2012, around 580) from 2010 to 2015. Until that date, Black arrestees' number belongs to an approximate interval of [580;800], with a high increase between 2012-2015 (approx. +35%). White arrestees belongs to the interval [600:800]. Both races decreases tremendously afterwards, but the black community always remains higher of +50 numbers of arrestees in average, which denotes well the disparity among races.

In 2015, some institutional policy must have been applied to decrease the number of arrestee preventively or punishingly because the number of arrestees has decreased for both white and black citizens. The trend of a decrease in the number of arrestees is observed one year later for women: in 2016. Women arrestees number is quite stable, oscillating in an interval of [100;200] for white women and [50;150]



```{r Arrestation-Male-Female-Black-White, fig.cap="Evolution of the number of arrestation between male and female",fig.align='center', warning=FALSE, message=FALSE, echo = FALSE}

Police_arrest_made %>%
  count(`Arrestee's Race`, `Arrestee's Gender`, year) %>%
  filter(!is.na(`Arrestee's Race`)) %>%
  ggplot(aes(x=year,y=n, fill= factor(`Arrestee's Race`), col= `Arrestee's Race`)) +
  geom_line() +
  facet_grid(~`Arrestee's Gender`)+
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  theme(legend.position ="bottom") +
  theme(legend.key.size = unit(0.5, "cm"))  +
  labs(title = "Higher number of arrestation for male people",
       subtitle = "Most of the time: white arrested = female, black arrested = Male",
       x= "Year",
       y="Number of arrestation"
       ) +
  scale_x_continuous( breaks = seq(2010,2019,by=1))
```

And what about their ages?
The age and the race would complete the profile of our arrestees. White arrestees are slightly younger (27-28 yo) considering the median than black people (34-35yo), Even the 1rst and 3rd modes are present a difference of about 5 years, making black arestees older. And we note that the mean age of black arrestees in slightly superior to the white arrestees mean age. The mean ages are respectedly 33 years for black people and 25 for white people, as observed in the figure \@ref(fig:Arrestation-age).

```{r Arrestation-age, fig.cap="Age of the arrested people related to the race", fig.align='center',warning=FALSE, message=FALSE, echo = FALSE}

Police_arrest_made%>%
  ggplot(aes(x=`Arrestee's Race`,y= `Arrestee's Age`, color=`Arrestee's Race` ))+
  geom_boxplot() +
  facet_grid(~`Arrestee's Gender`)+
  labs (
    title = "Median age higher for the black arrested",
    subtitle = "Arrested pepople between 2010 and 2019",
    x= "Arrestee's Race",
    y= "Age"
    )
```


We would now consider the type of arrestations \@ref(fig:Arrestation-type-arrestation). Black arrestees have more chance to be taken into custody than white people (chance until 2 times the white people have in 2011). It's hitting to remark that the heavier measures police officers could apply to arrestees is attributed in those proportions to black people and this difference in treatment among races remains quite stable. Each year verifying the schocking gap between white and black arrestees taken into custody.
 
Since 2012, the black proportion of peolple summoned or cited increased to reach 300 arrestees per year, in 2015 and 2016. The curve for white arrestees depicts a yearly decrease, starting in 2010 with a number higher than 400, reaching a flat stage for about 3 years (2012-2015) and the decreased has accelerated since this moment. However, we note that in this category as well, the curves of respectively black and white people arrested have become mixed for the past 5 years, making this sample as well not representative for the entire population of Chapel Hill. 

The same comment could be made for arrestees categorized "on view"", with a tinier gap between white and black people, but always at the cost of black persons.

```{r Arrestation-type-arrestation, fig.cap="Number of arrestation separeted by type and race", fig.align='center',warning=FALSE, message=FALSE, echo = FALSE}

##Analyze the type of arrestation taking into account the race

Police_arrest_made %>%
  count(`Arrestee's Race`, `Type of Arrest`, year)%>%
  filter(!is.na(`Type of Arrest`)) %>%
  ggplot(aes(x=year,y=n, fill= factor(`Arrestee's Race`), col= `Arrestee's Race`)) +
  geom_line() +
  facet_grid(~`Type of Arrest`)+
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  theme(legend.position ="bottom") +
  theme(legend.key.size = unit(0.5, "cm"))  +
  labs(title = "Black arrestees are mostly taken into custody",
       subtitle = "Arrestations by type of arrest",
       x= "Year",
       y="Number of arrestation") +
  scale_x_continuous( breaks = seq(2010,2019,by=1))


```


Victims and arrestees are now confronted in order to now the distribution of conflicts \@ref(tab:victim-arrested). The interracial conflicts are lower than white vs white and black vs black complaints. The proportion of white victims here, neglecting any observations involving other races (Asian, Hispanic, etc.), is a subset closer to the real population. Black victims represent 34.31% of this sample of victims, whereas the real proportion of black is approx. 10% over 100% of population. In spite the 34.31% is clearly a higher rate than the proportion of black victims we could have expected, we won't investigate the potential causes of this great rate. The point here is really to confront racial and interracial conflicts distribution. 


 
```{r victim-arrested,warning=FALSE, message=FALSE, echo = FALSE}

Table_joint<-left_join(Incident_reports, Police_arrest_made, by = c("Date of Occurrence"="Date of Arrest"))


Table_joint_2 <- Table_joint %>%
              select(year.x,`Arrestee's Race`, `Victim Race`) 




table(Table_joint_2$`Victim Race`,Table_joint_2$`Arrestee's Race`) %>%
 kable( 
  caption = "Vertical = Victim  |  Horizontal = Arrested", digits = 2
  ) %>% 
  kable_styling(
  bootstrap_options = "striped"
  )
  

```


## Drivers and Passengers' socio-demographics

Finally, we decided to analyse the traffic arrestation and again to differentiate black to white people. To do so, we chose an alternative method based on percentage: a ratio determining how many black citizens more were arrested for a certain motive of arrestx, scaled by the number of white arrestees, per year.

The most striking information is the ratio is the highest for police investigation. In other words, for each 10 white citizen arrested for investigation, whatever the gender is, at least 16 black persons already have been arrested. Those 60% of difference between those two races clearly signifies a correlated disproportion. However, narrowing down the specific cause of it is impossible and is not part of the present work. 

The reader has to keep in mind the black inhabitants' proportion in demographics dated 2010 in Chapel Hill (10%) and our extrapolation: (+/- 1.2%) per year, with respect to the whole population. The present arrestees sample is absolutely not representative of our population, even if estimated.

In Figure \@ref(fig:Traffic-Ratio-Black-White), if the bar is higher than 50%, it mean that more black persons are arrested and inversely. We note that for the purpose "Investigation", more black are arrested for the both year and independently of  the gender. The feature "Driving while impaired"" concern mostly black males.


```{r Traffic-Ratio-Black-White, fig.cap="More black are arrested",fig.align='center', warning=FALSE, message=FALSE, echo = FALSE}

 Traffic_stop_2 <- Traffic_stop_2 %>% mutate(Pro_Black_white = Black/White)
 Traffic_stop_2$Pro_Black_white[is.nan(Traffic_stop_2$Pro_Black_white)]<-0
 
 
Traffic_stop_2 %>% group_by(Purpose, Gender) %>%
ggplot(aes(x= reorder(Purpose,Traffic_stop_2$Pro_Black_white) , y= Traffic_stop_2$Pro_Black_white)) +
  geom_bar(stat = "identity") +
  facet_grid(Gender~Year) +
  labs(title = "More black arrested for the investigation purpose" ,subtitle = "for the year 2014-2015", x= "Purpose", y= "Ratio Black/White")+
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
   scale_y_continuous(labels = scales::percent) +
  theme( strip.background  = element_blank(),
                      panel.grid.major = element_line(colour = "black"),
                      panel.border = element_blank(),
                      axis.ticks = element_blank(),
                      panel.grid.minor.x=element_blank(),
                      panel.grid.major.x=element_blank() )

```


To refine the exploration, we want to know what type of arrest prevails per year \@ref(fig:Traffic-stop).

The strict majority among arrestation categories is speed limit violation, which overpass 4'000 arrestations per year, in both 2014 and 2015, and whose gender proportion approximate a 55%-45% (quite homogeneous). Speed violation is a daily risk for drivers, whether it is voluntary done or not. For this reason, speed violation was intuititive first cause of verbalization. 

The second and third causes of arrest concerned violation of vehicle regulations or equipment regulations. Which is interesting to note here is that the first causes of arrests, whose number of occurences exploded in 2014 and 2015, concerns a behavioral cause. Behavioral causes could imply violent reactions from police officers who are/feel agressed, whereas non-behavioral causes (ex. vehicule equipment violation) lead less to violence or other bias in decision making for  arresting the verbalized person(s). 
Other behavioral causes are fewly reported: (safe or other) movement violations, driving whiled impaired, etc. Offensive or violent behaviors are not significantly represented here other than potentially trhough speed violation which, as we previously said, could be unwanted.


```{r Traffic-stop, fig.cap="The higer purpose is the speef of limit",fig.align='center', warning=FALSE, message=FALSE, echo = FALSE}

Traffic_stop_2<-Traffic_stop_2 %>% filter(Purpose != "Total" & Purpose != "FemaleTotal" & Purpose != "MaleTotal")

ggplot(Traffic_stop_2, aes(x=Purpose, y= Traffic_stop_2$`Total By Ethnicity`, fill= Gender)) +
  geom_bar(stat = "identity") +
  facet_wrap(~Year) +
  labs(title = "The main cause of traffic arrestation is speed limit violation" ,subtitle = "For the year 2014-2015", x= "Purpose", y= "Total stop by race") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```





<!--chapter:end:Exploration_analysis.Rmd-->

# Introduction

## Overview and Motivation

Our motivation is to work on the characteristics of arrestations explaining a racial bias of the American judicial system applied. In addition to shootings on public places, cliché rift between black/white people often agitates news and press and stirs up American society. For this project we will use data from Chapel Hill Open Data, which compiles observations on police officers, victims and arrestees.

By using the CHPD database, far from finding an universal answer applicable to the United States of America in a whole, because our sample does not allow us to do so, we have the possibility of considering the socio-demographic characteristics of offenders and police officers over a defined  time span in order to check whether the cliché racial targetting can be confirmed or refuted. The use of this database potentially allows us to identify some potentially significant correlations between factors of delinquency or bias among police officers

Our goal is to find some significant correlation between the variables in order to profile the different offenders and see if these profiles infer with the typical characteristics of police profiles. 
From sociodemographic of the people arrested do some insight stem on some contributing factors of arrestation among a certain type of population or a precise distribution of offenders, as well as a homogeneous population of victims or not?


## The data

```{r warning=FALSE, message=FALSE, echo = FALSE}


Traffic_stop_2<-read_delim("data/initial-purpose-of-traffic-stop-by-drivers-sex-race-and-ethnicity.csv", ";", escape_double = FALSE, trim_ws = TRUE)
 
Police_arrest_made <- read_delim("data/police-arrests-made.csv",";", escape_double = FALSE, trim_ws = TRUE)
 
Employee_demographics<- read_delim("data/police-employee-demographics.csv",";", escape_double = FALSE, trim_ws = TRUE)

Incident_reports <-  read_delim("data/police-incident-reports-written.csv",";", escape_double = FALSE, trim_ws = TRUE)

```


```{r warning=FALSE, message=FALSE, echo = FALSE}
  Police_arrest_made <- Police_arrest_made%>% 
   mutate( `Drugs or Alcohol Present` = fct_collapse(`Drugs or Alcohol Present`,
    "Yes"="Y",
    "No"="N",
    "Unknown"="U"
    )) %>%
   mutate(`Arrestee's Race` = fct_collapse(`Arrestee's Race`,
    "Asian"="A",
    "Black"="B",
    "Hispanic"="H",
    "Native American"="I",
    "Other" ="O",
    "Unknown"="U",
    "White"="W")) %>%
  mutate(`Arrestee's Gender`=fct_collapse(`Arrestee's Gender`,
        "Female"="F",
        "Male"="M")) %>%
  mutate(`Type of Arrest`=fct_collapse(`Type of Arrest`,
         "TAKEN INTO CUSTODY"="TAKEN INTO CUSTODY (WARRANT/LP)")) %>%
  filter(`Arrestee's Race`=="Black" | `Arrestee's Race` == "White")

  
Incident_reports<- Incident_reports%>% 
  mutate(`Victim Race` = fct_collapse(`Victim Race`,
    "Asian"="A",
    "Black"="B",
    "Hispanic"="H",
    "Native American"="I",
    "Other" ="O",
    "Unknown"="U",
    "White"="W")) %>%
  mutate(`Victim Gender`=fct_collapse(`Victim Gender`,
    "Female"="F",
    "Male"="M")) %>%
  filter(`Victim Age`<100)  %>%
  filter(`Victim Race`=="Black" | `Victim Race`=="White") 

Employee_demographics<- Employee_demographics %>%
  mutate(Race = fct_collapse(Race,
    "Asian"="A",
    "Black"="B",
    "Hispanic"="H",
    "Native American"="I",
    "Other" ="O",
    "Unknown"="U",
    "White"="W")) %>%
  mutate(Gender=fct_collapse(Gender,
    "Female"="F",
    "Male"="M"))%>%
  filter(Race=="Black" | Race=="White")

Traffic_stop_2 <- Traffic_stop_2 %>%
  mutate(Gender= fct_collapse(Gender,
        "Female"="F",
        "Male" = "M"))

```

As mentioned above, for this assignement we use then Chapel Hill Crime and Police Data.

These sets of datasets will focus on gathered information by Chapel Hill on the town and ts citizen. This readme is a compilation of information that represents what each file will be about. Most of the datasets can be understood by reading the summary page from the Chapel Hill Open Data: [website](https://www.chapelhillopendata.org/explore/?sort=modified&refine.keyword=Police)

We are going to use four differents tables. We didn't have to do any data cleansing. We only renamed the levels of a few observations for the understanding of the reader (ex: "B" renamed as "Black").


### Police Employee Demographics
This dataset contains demographics information for employees of the Chapel Hill Police Department. Current as of October 2016.
Observations: 174
Variables: 7

In the table \@ref(tab:Table-Police-Employee-Demographics), we are going to use the 6 followings variables.

```{r Table-Police-Employee-Demographics, warning=FALSE, message=FALSE, echo = FALSE}
Employee_demographics %>%
  select(-`Officer ED No.`) %>%
  head(5) %>%
    kable(caption= "Employee Demographics", digits=2) %>%
  kable_styling(bootstrap_options = "striped")
``` 


### Victims' socio-demographics

This dataset, named "Police Incidents Reports", contains incident reports filed by the CHPD. Multiple incidents may have been reported at the same time. The most serious incident is shown for each report filed. Data available since January 1, 2010 and updated quarterly.
Observations: 82’525
Variables: 18

For this project, we are going to use the 6 variables appearing in the table \@ref(tab:Table-Incidents-Reports). Those variables seems to be the most important for our project.

```{r Table-Incidents-Reports, warning=FALSE, message=FALSE, echo = FALSE}
Incident_reports%>%
  select(`Date of Report`,`Date of Occurrence`,`Reported As`,`Victim Age`,`Victim Race`,`Victim Gender`) %>%
  head(5)%>%
  na.omit(Incident_reports) %>%
    kable(caption= "Table victims' socio-demographics") %>%
  kable_styling(bootstrap_options = "striped")


``` 

### Arrestees' socio-demographics
This dataset contains arrests made by the Chapel Hill Police Department. Multiple individuals may have been arrested under the same arrest number during related incidents or arrests. Data available since January 1, 2010 and updated quarterly.
Observations: 16040
Variables: 12

There are all the arrests from 2010 to 2019. We take into account the 7 variables that you can see in the table  \@ref(tab:Table-Police-Arrest-Made),

```{r Table-Police-Arrest-Made, warning=FALSE, message=FALSE, echo = FALSE}

Police_arrest_made %>%
  select(-`Incident Id`,-`Time of Arrest`,-Address, -`Arrestee's Ethnicity`, -`Primary Charge`)%>%
  na.omit(Incident_reports) %>%
  head(5) %>%
    kable(caption= "Arrestees' socio-demographics", digits=2) %>%
  kable_styling(bootstrap_options = "striped")
``` 


### Drivers and Passengers' socio-demographics
This dataset contains data on the initial purpose of traffic stops, entered in the data base by gender, race, and ethnicity.
Observations: 46
Variables:12

In this dataset, we are going to use the 6 followings variables.
```{r Table-Traffic-Stop-2, warning=FALSE, message=FALSE, echo = FALSE}
Traffic_stop_2 %>%
  select(Year,Purpose,Gender,White,Black) %>%
  head(5) %>%
    kable(caption= "Drivers and Passengers' socio-demographics", digits=2) %>%
  kable_styling(bootstrap_options = "striped")

``` 





<!--chapter:end:Introduction.Rmd-->


# Modeling

Once the exploration analysis done, we pursue with the modelization of the profile of our arrestees and victims. As a gentle reminder, the aim of our project is to build the typical profil drawn by the database in order to know whether or not race has a strong influence and thus, to consider if there is objectively a partial legal force.

## Modeling - Arrestees

### With a normal distribution

```{r , include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
  
  
```{r warning=FALSE, message=FALSE, echo = FALSE}

Arrestation= Police_arrest_made %>%
  group_by(`Arrestee's Age`,`Arrestee's Race`, `Arrestee's Gender`, `Drugs or Alcohol Present` ) %>%
  summarize(arrestation=n())


```


We would first build the model for arrestee’s profile. In order to do so, we use a gaussian General Linear Model to shape our dependent variable, the number of arrestation, explain by our independent variables: the age, race and gender of the arrestee and if it was under the influence of drugs and alcool. We use dummy variables to better understand the impact of the outcomes.

```{r model_arrestation_normal}
model <- glm(
  arrestation ~ `Arrestee's Age`+`Arrestee's Race`+`Arrestee's Gender` + `Drugs or Alcohol Present`,
  data = Arrestation
)

```

We observe that ceteris paribus, approximatively 49 arrestations (intercept) would be done in our reference case as we could observe in the table \@ref(tab:Table-estimate). The reference case is the average of possibility between all combinations possible with our variable references and here, since we have dummy variables, it encompasses  the lowest probable profile of arrestees: black women. This reference level gives the irreductible number of arrestations the Chapel Hill Police District would operate for this category on this subset of pupulation over 9 years. 

The arrestee Age has a negative effect: it depicts that higher is the age of the arrestee lower is the probability to encounter this person, since a high age would decrease, ceteris paribus, the number of arrestations in fine by the exact value of the age of the arrestee. This coefficient is significant.

The other significant coefficients are the gender of the arrestee and the presence of drugs and alcool, the last information is divided into two significant dummy variables. Being a male would higher by almost 29 additional arrestations, ceteris paribus. The male gender has a strong effect: + 58.10% of arrestations.
Drugs and alcohol dummy variables have as wellspring effects: The unknown presence of those substances decrease our outcome by approx. 16 arrestations (-15.63), ceteris paribus, while their presence would increase by almost 19 arrestations (18.83). 

Unfortunately, this model does not give us the expect insight on race: being white is positively correlated with the number of arrestation, making white race a more probable characteristic in the typical arrestee profile. We should have intuitively deducted that indeed, however the coefficient is not significant. 


```{r Table-estimate,warning=FALSE, message=FALSE, echo = FALSE}


broom::tidy(model) %>% 
  mutate(p.value = paste(round(p.value, 4), pval_star(p.value))) %>%
  select(-statistic) %>%
  kable( 
  caption = "Information about the estimate of the model", digits = 2
  ) %>% 
  kable_styling(
  bootstrap_options = "striped"
  )

```

Those informations brought by the model are themselves accurate? To know it, we have to analyse the goodness of fit of the model and explore in more details the distribution of the errors and also the distribution or our data.

In Figure \@ref(fig:Residuals), we observe exterme value, which have a lot of weight concerning the distribution of our errors.


```{r Residuals, fig.cap="Residuals of the models about the arrested", warning=FALSE, message=FALSE, echo = FALSE}

#Bad prediction when the number of arrestation  increase

augment_model<- broom::augment(model)

p1<- augment_model %>% 
  ggplot(aes(x=arrestation,y=.resid)) + 
  geom_hline(yintercept = 0, colour = "bisque3", size= 1) + 
  geom_line() + 
  labs(
    x = "Arrestation", 
    y = "Residuals",
    title = "Bad prediction when the number\nof arrestation increase",
    subtitle = "Nomral distribution ")



p2<- Arrestation %>% 
ggplot()+
  geom_histogram(aes(arrestation))  +
  labs(
    title = "Arrestation distribution",
    x= "Number of arrestation",
    y= "Number of standard profile")

(p1 + p2) +
  plot_annotation(
    title = "Weight of the extreme value")


```

With the following table \@ref(tab:Table-Arrestation-2), we have a look on the extreme values of the above figures. 
The tricky exercise here is to understand that the extreme values are not: they are the frequency of the profiles of  people arrested: the white male with drugs and alcohol is y very common profile in the database, wherease the other combinations, representing one single person, exceed 180 different single profiles.
```{r Table-Arrestation, warning=FALSE, message=FALSE, echo = FALSE}

Arrestation %>%
  arrange( desc(arrestation)) %>%
  head(7) %>%
   kable( 
  caption = "Standard profile depending of the frequency of arrestations ", digits = 2
  ) %>% 
  kable_styling(
  bootstrap_options = "striped"
  )

```
 
 
Concerning the predictions of our response variable "Arrestation", we can observe in the figure \@ref(fig:Prediction-arrestation), that our predictions and our observed values overlap, which is good news.
On the other hand, our model has difficulty in predicting extreme values, especially for the white race.

```{r Prediction-arrestation, fig.cap="Prediction", warning=FALSE, message=FALSE, echo = FALSE}


augment_model %>% ggplot() +
  geom_boxplot(aes(x=Arrestee.s.Race, y= arrestation, col="Observed")) +
  geom_boxplot(aes(x=Arrestee.s.Race, y= .fitted, col="Fitted" )) +
  labs(title = "Well goodness-of fit",
       subtitle = "Between the observed and fitted value",
       x= "Race",
       y= "Arrestation",
       col= "Model")


```

But unfortunately we are not totally satisfied with our model: the residues are very high and our data does not follow a normal dsitribution. We can improve our model by changing the distribution. Therefore, now we do the same model and use a poisson distribution.

### With a poisson distribution 

Normal distribution describes continuous data which have a symmetric distribution, with a characteristic 'bell' shape, which is not the case in our data, as we observed in the figure \@ref(fig:Residuals). Therefore, to analyze the leeway of improvement of our model, we use the Poisson distribution and expect lower residuals and a better overall fit.

```{r model-arrestation-poisson}

model_poisson <- glm(
  arrestation ~ `Arrestee's Age`+`Arrestee's Race`+`Arrestee's Gender` + `Drugs or Alcohol Present`,
  data = Arrestation, family = "poisson"
)

```


All our estimates are significant with 0.1% except for the variable race as we observe in the table  \@ref(tab:Table-estimate-poisson). By comparison with the normal model (\@ref(tab:Table-estimate)) the variable sginificance are the same. Only the intercept is modified, which is smaller than previously, 3.84 instead of 49.24. The effect of the estimate remains similar and as previously, variable race isn't significant. 


```{r Table-estimate-poisson,warning=FALSE, message=FALSE, echo = FALSE}

broom::tidy(model_poisson) %>% 
  mutate(p.value = paste(round(p.value, 4), pval_star(p.value))) %>%
  select(-statistic) %>%
  kable( 
  caption = "Information about the estimate of the model", digits = 2
  ) %>% 
  kable_styling(
  bootstrap_options = "striped"
  )

```

In the figure, \@ref(tab:Table-estimate-poisson) we compare the distribution of the errors between the gaussian and the Poisson models. The first tables depicts the distribution of the residuals at the same scale (until -200). The gaussian residuals are greater than Poisson ones: the latter distribution better fits our dataset.

In a second time, we zoom in on the Poisson residuals to observe their distribution into an tiny interval of [-10, 10], which is pretty good.

```{r Residuals-poisson, fig.cap="Residuals of the models about the arrested", warning=FALSE, message=FALSE, echo = FALSE}

#Bad prediction when the number of arrestation  increase
augment_model_poisson<- broom::augment(model_poisson)


p11<- augment_model_poisson %>% 
  ggplot(aes(x=arrestation,y=.resid)) + 
  geom_hline(yintercept = 0, colour = "bisque3", size= 1) + 
  geom_line() + 
  labs(
    x = "Arrestation", 
    y = "Residuals",
    title = "Bad prediction when the number\nof arrestation increase",
    subtitle = "Poisson distribution") +
  scale_y_continuous(limits = c(-10,200))

p17<- augment_model_poisson %>% 
  ggplot(aes(x=arrestation,y=.resid)) + 
  geom_hline(yintercept = 0, colour = "bisque3", size= 1) + 
  geom_line() + 
  labs(
    x = "Arrestation", 
    y = "Residuals",
    title = "Zoom on the residuals distribution",
    subtitle = "Poisson distribution") 

((p11 + p1)/p17) +
  plot_annotation(
    title = "Distribution of the residuals")


```



In the next model, we add the type of arrest and whether the criminal is armed or not, in order to explain our response variable "Arrest". And this time, we use directly a poisson distribution.

```{r warning=FALSE, message=FALSE, echo = FALSE}


Arrestation_2= Police_arrest_made %>%
  group_by(`Arrestee's Age`,`Arrestee's Race`, `Arrestee's Gender`, `Drugs or Alcohol Present`, `Type of Arrest`,`Weapon Present`) %>%
  filter(`Arrestee's Race`=="Black" | `Arrestee's Race` =="White") %>%
  filter(`Drugs or Alcohol Present`!= "Unknown") %>%
  na.omit()%>%
  summarize(arrestation=n())

```

```{r model-arrestation-2, warning=FALSE, message=FALSE, echo = TRUE}

model_Arrestation_2 = glm(arrestation ~ `Arrestee's Age`+`Arrestee's Race`+`Arrestee's Gender` + `Drugs or Alcohol Present` + `Type of Arrest` + `Weapon Present`,family="poisson", data= Arrestation_2)

```


Compare to our previous model with less variables, the significance of the estimates does not change. 

The type of arrestations "Taken into custody" and being "Unarmed" are significant with 0.1%, as we observe in the table \@ref(tab:Table-Arrestation-2).


```{r Table-Estimate, warning=FALSE, message=FALSE, echo = FALSE}

broom::tidy(model_Arrestation_2) %>% 
  mutate(p.value = paste(round(p.value, 4), pval_star(p.value))) %>%
  filter(p.value<0.001) %>%
  select(-statistic) %>%
  kable( 
  caption = "Information about the estimate of the model", digits = 2
  ) %>% 
  kable_styling(
  bootstrap_options = "striped"
  )
```


The table \@ref(tab:Table-Arrestation-2) gives the most frequent profiles contained in our databases of arrested persons, including now type of arrests and drug or alcohol impaired. Again, the profils of young white males are the most frequent, and they are systematically not armed but impaired.

```{r Table-Arrestation-2, warning=FALSE, message=FALSE, echo = FALSE}

Arrestation_2 %>%
  arrange( desc(arrestation)) %>%
  head(7) %>%
   kable( 
  caption = "Information about the estimate of the model", digits = 2
  ) %>% 
  kable_styling(
  bootstrap_options = "striped"
  )

```


 


## Modelling - Victim

### With a normal distribution

The second modelization aims to model the profil of victims. Again, we use the simplest model possible: the gaussian General Linear model, to estimate the number of victims by population characteristics over 9 years. The variable taking into account the age, race and gender of the victims.
We reproduce the distinguo gaussian-Poisson as we did for arrestees' profiling in order to demonstrate again the better fit of the data by the use of a Poisson.

```{r warning=FALSE, message=FALSE, echo = FALSE}

Victim <- Incident_reports %>%
  group_by(`Victim Age`,`Victim Gender`,`Victim Race`) %>%
  summarize(Victim=n())

```
Like for the model of the arrestee profile, we improve our modelization by running after a Poisson model below:

```{r model-victim}

model_victim = glm(Victim ~ `Victim Age` + `Victim Gender` + `Victim Race` , data= Victim)

```

Again, we have a model with dummy variables (automatically created by the use of character variables, the software estimate the impact of the non-reference levels), so we have to first consider our reference level, which is black women, as we observe in the table \@ref(tab:Table-estimate-victim). The number of victims for those population, neglecting the age is approximatively 201 cases (200.56). This number is significant.

Considering now our variables: The age is negatively correlated with the number of victims by decreasing it with an effect of -2.70! We expect thus a larger number of young victims, since this coefficient is reliable since significant. Being white is a risk factor: more victims are white and this is represented by the strong positive effect of the dummy variable, significant as well, called `Victim Race'White: +86.79 so additional 87 number of victims by comparison to our reference level.

Here, we have a strong racial effect: black people report less in our data set: they seem to be less subject to misuse, aggressions, and other cases of abi. than white people. But exogeneous causes can cause it: white persons are maybe wealthier or adopt a behavioral attracting thiefs, perhaps black people are reluctant to fill a complaint in police office because of some pression, lack of interest or expecting disparagement, for exmaple.

Our database cannot help any supporting justification with those assumptions, because it does not contain any data to verify them.

Finally, the interesting point remains that gender is not significant, in spite of the negative effect (in the model, but a benefit in reality) to be a male. Being a male decreases, ceteris paribus, the number of cases by approximatively 13 victims (13.42).


```{r Table-estimate-victim,warning=FALSE, message=FALSE, echo = FALSE}
augment_model_victim<- broom::augment(model_victim)


broom::tidy(model_victim) %>% 
  mutate(p.value = paste(round(p.value, 4), pval_star(p.value))) %>%
  select(-statistic) %>%
  kable( 
  caption = "Information about the estimate of the model", digits = 2
  ) %>% 
  kable_styling(
  bootstrap_options = "striped"
  )

```
 
 The errors are distributed around zero, leading to low errors scores, satisfying! But some errors remains as outliers, Errors value follow a gaussian distribution here as well, illustrating quite a poisson curve.

 In Figure \@ref(fig:Residuals-victim), we observe 

```{r Residuals-victim, fig.cap="Residuals of the models about the model victim", warning=FALSE, message=FALSE, echo = FALSE}

#Bad prediction when the number of arrestation  increase

p3<- augment_model_victim %>% 
  ggplot(aes(x=Victim,y=.resid)) + 
  geom_hline(yintercept = 0, colour = "bisque3", size= 1) + 
  geom_line() + 
  labs(
    x = "Number of victims", 
    y = "Residuals",
    title = "Bad prediction when the number\nof arrestation increase",
    subtitle = "Normal distribution")

p4<- Victim %>% 
ggplot()+
  geom_histogram(aes(Victim))  +
  labs(
    title = "Dstribution around 0",
    subtitle = "Victim distribution",
    x= "Number of victim",
    y= "Number of standard profile")

(p3 + p4) +
  plot_annotation(
    title = "Residuals variation")



```

In order to well undersant what is inside the extreme value as we obsevre  the figure \@ref(fig:Residuals-victim), we present the seven typical profil of a victim , in the table \@ref(tab:Table-distribution-Victim), we notice that the victim is all the time a young white person.


```{r Table-distribution-Victim, fig.cap="Dstribution of the residuals", warning=FALSE, message=FALSE, echo = FALSE}

Victim %>%
  arrange( desc(Victim)) %>%
  head(7) %>%
   kable( 
  caption = "Information about the estimate of the model", digits = 2
  ) %>% 
  kable_styling(
  bootstrap_options = "striped"
  )

```


The box plot of the model’s goodness of fit points out that our model better predict black than white people: the dummy variable struggles to well fit the observation, as we notice in the figure \@ref(fig:Prediction-model-victim)

```{r Prediction-model-victim, fig.cap="Prediction victim model", warning=FALSE, message=FALSE, echo = FALSE}

augment_model_victim %>% ggplot() +
  geom_boxplot(aes(x=Victim.Race, y= Victim, col="Observed")) +
  geom_boxplot(aes(x=Victim.Race, y= .fitted, col="Fitted" )) +
  labs(title = "Well goodness-of fit",
       subtitle = "Between the observed and fitted value",
       x= "Race",
       y= "Number of victim",
       col= "Model")

```

Like the model with arrested, we made an error making the assumption that are data follow a normal distribution, but it was not the case as we note obersving the distribution of the data in the figure \@ref(fig:Residuals-model-victim). Therefore, now we assume that our data follow a poisson distribution.


```{r model-victim-poisson}

model_victim_poisson = glm(Victim ~ `Victim Age` + `Victim Gender` + `Victim Race` ,family = "poisson", data= Victim)

```

Again, we have a model with dummy variables, so we have to first consider our reference level, which is black women again, as we observe in the table \@ref(tab:Table-estimate-victim-poisson). All the variables are significant as in the previsous table with a normal distribution \@ref(tab:Table-estimate-victim). But here, all the variables are significant with 1%, which it was not the case previously. Here the varaibles male is negatively signicant, and before it was positively correlated. 

It is more correct to use this following  table \@ref(tab:Table-estimate-victim-poisson). 



```{r Table-estimate-victim-poisson,warning=FALSE, message=FALSE, echo = FALSE}
augment_model_victim_poisson<- broom::augment(model_victim_poisson)


broom::tidy(model_victim_poisson) %>% 
  mutate(p.value = paste(round(p.value, 4), pval_star(p.value))) %>%
  select(-statistic) %>%
  kable( 
  caption = "Information about the estimate of the model", digits = 2
  ) %>% 
  kable_styling(
  bootstrap_options = "striped"
  )

```

Plotting our residuals with a poisson distribution we note that we are pretty good,\@ref(tab:Residuals-victim-poisson).

```{r Residuals-victim-poisson, fig.cap="Residuals of the models about the model victim", warning=FALSE, message=FALSE, echo = FALSE}

#Bad prediction when the number of arrestation  increase

p13 <-augment_model_victim_poisson %>% 
  ggplot(aes(x=Victim,y=.resid)) + 
  geom_hline(yintercept = 0, colour = "bisque3", size= 1) + 
  geom_line() + 
  labs(
    x = "Number of victims", 
    y = "Residuals",
    title = "Bad prediction when the number\nof arrestation increase",
    subtitle = "Poisson distribution") +
  scale_y_continuous(limits = c(-200,400))

p15 <-augment_model_victim_poisson %>% 
  ggplot(aes(x=Victim,y=.resid)) + 
  geom_hline(yintercept = 0, colour = "bisque3", size= 1) + 
  geom_line() + 
  labs(
    x = "Number of victims", 
    y = "Residuals",
    title = "Zoom on the residuals distribution",
    subtitle = "Poisson distribution")

 
((p13 + p3)/ p15) +
  plot_annotation(
    title = "Residuals variation")




```


## Classifying

Finally, because no variable concerning the arrestee's race was significant, we would now see with a machine learning process if the black box is able to well predict the skin color of the person arrested.

If the process succeeds, then there would be an evidence that black or white race might have an affect on arrestation in the District of Chapel Hill because they can be predicted by the variables we selected for the model: the characteristics of the arrestations would be a key factor to forecast the skin color of the arrestee.

If not, then our data base does not allow us to demonstrate any bias in the judicial system of a county if ad only if our samples are respresentative  of our population. If this is not the case, then further investigation have be done in order to minimize the sampling bias we face here.

So, we filtered again the data to have only black and white arrestees and mutate all the character variables as factors, so as to be handled by the functions, which require factors only. We proceed to a sammpling for having a training and a test sets with which we would train and verify the analytical process.

This one is a Random Forest: Through a multiplicity of random samples we did before: our model has to predict the race pf arrestees with respect of the characteristics of the observations included in the samples. By computing an average of their results, we determine the model's ability to predict.

In the figure \@ref(fig:Prediction-model-race), we plot the cofusion matrix.


```{r Prediction-model-race, fig.cap="Race prediction model", fig.asp = 0.7, fig.width = 7, fig.align = 'center', warning=FALSE, message=FALSE, echo = FALSE}

PAM <- Police_arrest_made %>%
  clean_names() %>%
  filter(arrestees_race == c("Black","White")) %>%
  mutate(arrestees_race =if_else(arrestees_race == "Black", "Black", "White", missing = NA_character_) %>% factor()) %>%
  na.omit() %>% 
  select(arrestees_race, arrestees_age, type_of_arrest, drugs_or_alcohol_present, weapon_present) %>%
  mutate_if(is.character, as.factor)
  
set.seed(123)
index.tr <- c(sample(1:100, replace=FALSE, size=65),100+sample(1:100, replace=FALSE, size=65),200+sample(1:100, replace=FALSE, size=65))

arrest.tr <- PAM[index.tr,]
arrest.te <- PAM[-index.tr,]
# creation of the random forest model

mod.rf <- randomForest(formula = arrestees_race ~ arrestees_age + type_of_arrest + drugs_or_alcohol_present + weapon_present,
                       data = PAM)
# using the test set to see is good or not
pred.te <- predict(mod.rf, newdata=arrest.te, type="class")

confusionMatrix<-confusionMatrix(data=pred.te, reference = arrest.te$arrestees_race)


fourfoldplot(confusionMatrix$table)
```
 
We have to look at the sensitivity (ability to predict true positive, here black people) and specificity (ability to predict true negative, here whites), as well the accuracy: if our model well predicts in average the outcome, in the table  \@ref(tab:Table-Arrestation-2). Here, the accuracy is a little bit better than hazard (0.6611 against 0.5, considered here as hazard since we have only two outcomes). The sensitivity (.7560) is quite high but specificity is low (.5578). Our model predicts well black but have more difficulty to predict white, which was the issue we faced with our other two models: the white race level is non-significant.

Of course, we are now working with a biased sample. The learner's struggles are explained to a certain extent by this bias. The improvements we could have done would have been to create a subset of our dataset by randomly selecting 10% of black arrestees and 90% of white arrestees to respect the real proportion of Chapel Hill's population.

In this way, the learner would have work on less biased subset of observations and the results would have given us a better classification of arrestees per skin color.

 
```{r Table-Confision-matrix, fig.cap="Race prediction model", warning=FALSE, message=FALSE, echo = FALSE}

confusionMatrix$byClass %>%
    kable( 
  caption = "Output of the confusion matrix", digits = 2
  ) %>% 
  kable_styling(
  bootstrap_options = "striped"
  )
```





<!--chapter:end:Modeling.Rmd-->

`r if (knitr:::is_html_output()) '
# References {-}
'`


<!--chapter:end:references.Rmd-->

